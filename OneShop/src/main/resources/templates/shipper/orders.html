<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	layout:decorate="~{layouts/guest}">

<head>
<title>Đơn hàng Shipper</title>
<th:block layout:fragment="css">
	<link
		href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
		rel="stylesheet">
	<link rel="stylesheet" th:href="@{/assets/css/common.css}">
	<style>
/* ===== Cấu trúc tổng thể ===== */
.container {
	margin-top: 40px;
	margin-bottom: 100px; /* để tránh footer đè */
}

h1, h2 {
	font-weight: 600;
	margin-bottom: 20px;
}

/* ===== Bảng ===== */
.table {
	border-radius: 8px;
	overflow: hidden;
}

.table thead th {
	font-size: 18px; /* tăng kích thước chữ */
	font-weight: 600;
	background-color: #f8f9fa;
	text-align: center;
	vertical-align: middle;
	padding: 14px;
}

.table tbody td {
	font-size: 16px;
	text-align: center;
	vertical-align: middle;
	padding: 12px;
}

/* ===== Nút giao hàng ===== */
.btn-deliver {
	font-size: 15px; /* to hơn mặc định */
	padding: 10px 18px; /* tăng độ lớn vùng bấm */
	border-radius: 8px;
}

/* ===== Nút quay lại ===== */
.btn-back {
	position: fixed;
	bottom: 25px;
	right: 25px;
	z-index: 1050; /* luôn nằm trên footer */
	padding: 10px 20px;
	font-size: 16px;
	border-radius: 8px;
	box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

/* ===== Thống kê ===== */
.list-group-item {
	font-size: 17px; /* tăng kích thước chữ */
	padding: 12px 16px; /* khoảng cách trong rộng hơn */
}
</style>
</th:block>
</head>

<body sec:authorize="hasRole('ROLE_SHIPPER')">
	<div layout:fragment="content">
		<div class="container">
			<!-- Header -->
			<header class="mb-4">
				<h1 class="text-primary">Đơn hàng được giao</h1>
			</header>

			<!-- Bảng đơn hàng -->
			<table class="table table-bordered table-hover shadow-sm">
				<thead>
					<tr>
						<th>ID</th>
						<th>Người mua</th>
						<th>Tổng tiền</th>
						<th>Trạng thái</th>
						<th>Ngày tạo</th>
						<th>Hành động</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="order : ${orders}">
						<td th:text="${order.id}"></td>
						<td th:text="${order.user.username}"></td>
						<td
							th:text="${#numbers.formatDecimal(order.total, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></td>
						<td th:text="${order.orderStatus}"></td>
						<td
							th:text="${#temporals.format(order.createdAt, 'dd/MM/yyyy HH:mm')}"></td>
						<td>
							<div th:if="${order.orderStatus != 'DELIVERED'}">
								<form
									th:action="@{/shipper/orders/{id}/deliver(id=${order.id})}"
									method="post">
									<button type="submit"
										class="btn btn-success btn-sm btn-deliver">
										<i class="fas fa-check-circle"></i> Giao hàng thành công
									</button>
								</form>
							</div>
							<div th:if="${order.orderStatus == 'DELIVERED'}">
								<span class="text-success fw-bold">Đã giao</span>
							</div>
						</td>
					</tr>
				</tbody>
			</table>

			<!-- Thống kê -->
			<section class="mt-5">
				<h2>Thống kê</h2>
				<ul class="list-group">
					<li class="list-group-item" th:each="entry : ${stats}"
						th:text="${entry.key} + ': ' + ${entry.value}"></li>
				</ul>
			</section>
		</div>

		<!-- Nút quay lại -->
		<a th:href="@{/}" class="btn btn-secondary btn-back"> <i
			class="fas fa-arrow-left"></i> Quay lại
		</a>

	</div>

	<!-- FontAwesome icons -->
	<script src="https://kit.fontawesome.com/a2e0e6ad1d.js"
		crossorigin="anonymous"></script>
</body>
</html>
